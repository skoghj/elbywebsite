---
import InfoCard from "./InfoCard.astro";
---

<section class="relative h-[700vh] bg-primary-500">
  <!-- Sticky container -->
  <div id="scrollytelling-wrapper" class="sticky top-0 h-screen flex items-center justify-center overflow-hidden">
    <div id="slides-container" class="relative w-full h-full">
      <div class="slide slide-center absolute inset-0 opacity-0">
        <!-- Baggrundsbillede med mørk gradient overlay -->
        <div class="absolute inset-0 bg-cover bg-center" style="background-image: url('../about/hero_omelby.webp');">
          <div class="absolute inset-0 bg-black bg-opacity-70"></div>
        </div>

        <!-- Indhold ovenpå baggrunden -->
        <div class="relative z-10 flex flex-col items-center justify-center text-center h-full px-6">
          <div class="w-full max-w-lg md:max-w-4xl mb-8">
            <h1 class="font-bold text-display-mobile md:text-display-tablet lg:text-display-desktop text-white">VELKOMMEN TIL <span class="text-acc_yel-500">ELBY</span></h1>
            <p class="text-xl md:text-3xl mt-xs text-white">Et passioneret team med en fælles mission: at fremme den grønne omstilling, ved at gøre det let at lade din elbil, med en løsning der passer til byen</p>
          </div>
        </div>
      </div>

      <!-- Slide 2 -->
      <div class="slide absolute inset-0 opacity-0 flex flex-col md:flex-row items-center justify-center md:text-left px-6">
        <div class="w-full md:w-1/2 max-w-xl order-2">
          <p class="text-xl md:text-3xl p-md">
            Forestil dig, at virksomheder og borgere arbejdede sammen for et <span class="font-bold">bedre klima</span>, et renere miljø, bedre luftkvalitet, mindre støj og en <span class="font-bold">bedre fremtid</span> for vores børn.
          </p>
        </div>
        <div class="w-full md:w-1/2 order-1">
          <img src="../about/scroll_omelby_1.webp" class="w-full max-w-xl mx-auto shadow-lg" alt="Stemningsbilled ud over kanalen ved Nordhavn" />
          <!-- Updated -->
        </div>
      </div>

      <!-- Slide 3 -->
      <div class="slide absolute inset-0 opacity-0 flex flex-col md:flex-row items-center justify-center md:text-left px-6">
        <div class="w-full md:w-1/2 max-w-xl order-1">
          <p class="text-xl md:text-3xl p-md">
            Forestil dig, at bilerne kunne være en <span class="font-bold">ressource for byen</span>. Først og fremmest skulle det være let og billigt at lade dem op, så ingen tøvede med at skifte deres benzin- eller dieselbil ud.
          </p>
        </div>
        <div class="w-full md:w-1/2 order-2">
          <img src="../about/scroll_omelby_2.webp" class="w-full max-w-xl mx-auto shadow-lg" alt="Elby der kører på vej" />
          <!-- Updated -->
        </div>
      </div>

      <!-- Slide 4 -->
      <div class="slide absolute inset-0 opacity-0 flex flex-col md:flex-row items-center justify-center md:text-left px-6">
        <div class="w-full md:w-1/2 max-w-xl order-2">
          <p class="text-xl md:text-3xl p-md">
            Dernæst kunne elbil-opladerne være en <span class="font-bold">indtægtskilde</span> for bygningsejerne, når de lader dem op med etagebygningens delestrøm. Det er godt for bygningens økonomi.
          </p>
        </div>
        <div class="w-full md:w-1/2 order-1">
          <img src="../about/scroll_omelby_3.webp" class="w-full max-w-xl mx-auto shadow-lg" alt="Mand der kigger på Elby app mens han lader bilen." />
          <!-- Updated -->
        </div>
      </div>

      <!-- Slide 5 -->
      <div class="slide absolute inset-0 opacity-0 flex flex-col md:flex-row items-center justify-center md:text-left px-6">
        <div class="w-full md:w-1/2 order-1 max-w-xl">
          <p class="text-xl md:text-3xl p-md">
            På sigt kunne elbilerne styrke elnettet ved at sælge lidt af deres strøm tilbage, når den er dyr. Så ville bilerne fungere som et <span class="font-bold">fælles batteri for byen,</span> der blot lader sig selv op, når strømmen bliver billig igen.
          </p>
        </div>
        <div class="w-full md:w-1/2 order-2">
          <img src="../about/scroll_omelby_4.webp" class="w-full max-w-xl mx-auto shadow-lg" alt="Luftfoto af biltrafik" />
          <!-- Updated -->
        </div>
      </div>

      <!-- Slide 6 -->
      <div class="slide slide-center absolute inset-0 opacity-0 flex flex-col items-center text-center justify-center px-6">
        <div class="w-full md:w-1/2 order-2 mt-md">
          <h2 class="text-display-mobile md:text-display-tablet lg:text-display-desktop font-bold">Forestil dig Elby - det gør vi</h2>
        </div>
      </div>
    </div>
  </div>
</section>

<!-- Motion One & Scroll Logic -->
<script type="module">
  import { animate } from "https://cdn.jsdelivr.net/npm/motion@10.16.4/+esm";

  const slides = document.querySelectorAll(".slide");
  const totalSlides = slides.length;

  let currentSlide = -1;

  const showSlide = (index) => {
    if (index === currentSlide) return;

    // Hide current
    if (currentSlide >= 0) {
      animate(slides[currentSlide], { opacity: 0, y: -40 }, { duration: 0.5, easing: "ease-out" });
    }

    // Show new
    animate(slides[index], { opacity: [0, 1], y: [40, 0] }, { duration: 1.1, easing: "ease-out" });

    currentSlide = index;
  };

  const onScroll = () => {
    const section = document.querySelector("section");
    const top = section.getBoundingClientRect().top;
    const viewportHeight = window.innerHeight;

    const scrollProgress = Math.min(Math.max(-top / viewportHeight, 0), totalSlides - 0.01);
    const index = Math.floor(scrollProgress);

    showSlide(index);
  };

  window.addEventListener("scroll", onScroll);
  window.addEventListener("load", () => showSlide(0));
</script>
